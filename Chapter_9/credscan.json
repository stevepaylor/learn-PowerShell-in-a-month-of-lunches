{
  "parameters": {
    "jobName": "credscan",
    "displayName": "Secret Scan",
    "pool": "windows-latest"
  },
  "jobs": [
    {
      "displayName": "${{ parameters.displayName }}",
      "job": "${{ parameters.jobName }}",
      "pool": {
        "vmImage": "${{ parameters.pool }}"
      },
      "steps": [
        {
          "displayName": "Scan for Secrets",
          "task": "securedevelopmentteam.vss-secure-development-tools.build-task-credscan.CredScan@2",
          "inputs": {
            "suppressionsFile": "tools/credScan/suppress.json",
            "debugMode": false,
            "toolMajorVersion": "V2"
          }
        },
        {
          "displayName": "Publish Secret Scan Logs to Build Artifacts",
          "task": "securedevelopmentteam.vss-secure-development-tools.build-task-publishsecurityanalysislogs.PublishSecurityAnalysisLogs@2",
          "continueOnError": true
        },
        {
          "displayName": "Check for Failures",
          "task": "securedevelopmentteam.vss-secure-development-tools.build-task-postanalysis.PostAnalysis@1",
          "inputs": {
            "ToolLogsNotFoundAction": "Error",
            "CredScan": true
          }
        }
      ]
    }
  ]
}
